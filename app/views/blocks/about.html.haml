%h3 About

%p
  This is a #{link_to "bitcoin", "http://bitcoin.org"} blockchain browser written in ruby
  using the #{link_to "bitcoin-ruby", "http://github.com/lian/bitcoin-ruby"} library.
%p
  The code is open source and available at
  #{link_to "block_browser", "http://github.com/mhanne/block_browser"}.

%p
  Donate to #{link_to BB_CONFIG['donate'], address_path(BB_CONFIG['donate'])} if you like the project.

%h3 Statistics

%table.details
  %tr
    %th Total Blocks
    %td
      - head = STORE.get_head
      = link_to head.depth, block_path(head.hash)
  -# %tr
  -#   %th Transactions
  -#   %td= STORE.db[:tx].count
  -# %tr
  -#   %th Unconfirmed
  -#   %td= link_to STORE.db[:unconfirmed].count, unconfirmed_path
  -# %tr
  -#   %th Inputs
  -#   %td= STORE.db[:txin].count
  -# %tr
  -#   %th Outputs
  -#   %td= STORE.db[:txout].count
  -# %tr
  -#   %th Addresses
  -#   %td= STORE.db[:addr].count

  %tr
    %th Total Coins
    %td
      - total = 0
      - (STORE.get_depth + 1).times {|i| total += calculate_reward(i + 1) }
      = format_amount total

  %tr
    %th Current Reward
    %td
      = format_amount calculate_reward(STORE.get_depth)

  %tr
    %th Reward Drop
    %td
      - drop = Bitcoin::Validation::REWARD_DROP
      in #{blocks = drop - (STORE.get_depth % drop)} blocks -
      - seconds = blocks * 10 * 60
      = (Time.now + seconds).strftime("%Y-%m-%d %H:%M")
      %br/
      (#{(Time.at(seconds) - 1.day).utc.strftime("%d days, %H hours, %M minutes")})
